{# Heredando la plantilla principal #}

{% extends 'default_layout.html' %}

{% block extraCSS %}

{% endblock %}

{% block javascripts %}
<script>
  $(document).ready(function(){
    $("#uploadBtn").click(function(e){
      e.preventDefault();
      let formData = new FormData($('#excelForm')[0]);
      
      $.ajax({
        url: 'php_libs/soporte/Herramientas/EntregaComputadoras.php',
        type: 'POST',
        data: formData,
        processData: false,
        contentType: false,
        dataType: 'json',
        success: function(response){
          // En función del estado devuelto, mostramos el mensaje
          if(response.status === "success"){
            $("#result").html("<div class='alert alert-success'>" + response.message + "</div>");
          } else {
            $("#result").html("<div class='alert alert-danger'>" + response.message + "</div>");
          }
        },
        error: function(xhr, status, error){
          $("#result").html("<div class='alert alert-danger'>Error: en Ajax" + error + "</div>");
        }
      });
    });
  });
</script>
{% endblock %}

{% block contenidos %}
<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper fondoBody">
    <!-- Content Header (Page header) 
    Se elimino content-header section solo se va dejar Main Content -->
    
  <!-- Main content -->
    <section class="content">
        <div class="container-fluid">
              <h1 class="mt-5">Subir Archivo Excel</h1>
              <form id="excelForm" enctype="multipart/form-data">
                <div class="form-group">
                  <label for="excelFile">Archivo Excel</label>
                  <input type="file" class="form-control" name="excelFile" id="excelFile" required>
                </div>
                <div class="form-group">
                  <label for="readColumn">Columna donde están los NIE (Ej: A)</label>
                  <input type="text" class="form-control" name="readColumn" id="readColumn" placeholder="A" required>
                </div>
                <div class="form-group">
                  <label for="nieStartRow">Fila de inicio del listado de NIE (Ej: 2)</label>
                  <input type="number" class="form-control" name="nieStartRow" id="nieStartRow" placeholder="2" required>
                </div>
                <div class="form-group">
                  <label for="startColumn">Columna para escribir los resultados (Ej: B)</label>
                  <input type="text" class="form-control" name="startColumn" id="startColumn" placeholder="B" required>
                </div>
                <div class="form-group">
                  <label for="codigo_ann_lectivo">Código del Año Lectivo</label>
                  <input type="number" class="form-control" name="codigo_ann_lectivo" id="codigo_ann_lectivo" placeholder="Ej: 2022" required>
                </div>
          
                <!-- Botón de tipo button para llamar la función Ajax -->
                <button type="button" id="uploadBtn" class="btn btn-primary">Subir y Procesar</button>
              </form>
              <!-- Div para mostrar el resultado -->
              <div id="result" class="mt-3"></div>
          </div>
    </section>  
</div> <!-- /.content-Wrapper, Contains page content. -->
{% endblock %}

{% block loginUser %}
<!--	{% include 'layout-login-user.html' %} -->
{% endblock %}